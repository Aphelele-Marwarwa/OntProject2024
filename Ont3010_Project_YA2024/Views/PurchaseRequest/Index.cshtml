@using System.Linq
@model IEnumerable<Ont3010_Project_YA2024.Models.InventoryLiaison.PurchaseRequest>

@{
    ViewData["Title"] = "Purchase Requests";
    Layout = "~/Views/Shared/_InventoryLiaisonLayout.cshtml";
}
@if (TempData["created"] != null)
{
    <div id="createdMessage" class="alert alert-success alert-dismissible fade show" role="alert">
        <i class="fas fa-check-circle"></i> @TempData["created"]
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
    </div>
}

@if (TempData["Error"] != null)
{
    <div id="errorMessage" class="alert alert-danger alert-dismissible fade show" role="alert">
        <i class="fas fa-exclamation-triangle"></i> @TempData["Error"]
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
    </div>
}
<div class="Fridge-details-container">
    <h2 class="text-center">
        <i class="fas fa-clipboard-list"></i> Purchase Requests
    </h2>

    <p class="text-center mb-4">
        <a class="btn btn-primary" asp-action="Create">
            <i class="fas fa-plus"></i> Create New Purchase Request
        </a>
    </p>

    <div class="table-responsive">
        <table class="table table-striped table-hover custom-table">
            <thead>
                <tr>
                    <th>Fridge Model/Type</th>
                    <th>Capacity</th>
                    <th>Quantity</th>
                    <th>Urgency</th>
                    <th>Justification</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                @if (Model != null && Model.Any())
                {
                    foreach (var item in Model)
                    {
                        <tr>
                            <td>@item.FridgeModelType</td>
                            <td>@item.Capacity</td>
                            <td>@item.Quantity</td>
                            <td>@item.Urgency</td>
                            <td>@item.Justification</td>
                            <td>
                                <a class="btn btn-info" asp-action="Details" asp-route-id="@item.PurchaseRequestId">
                                    <i class="fas fa-eye"></i> Details
                                </a>
                            </td>
                        </tr>
                    }
                }
                else
                {
                    <tr>
                        <td colspan="6" class="text-center">No purchase requests found.</td>
                    </tr>
                }
            </tbody>
        </table>
         <div class="pagination-container">
            @if (Model != null && Model.Any())
            {
                <div class="pagination">
                    @if (ViewBag.CurrentPage > 1) // Check if current page is greater than 1 for Previous button
                    {
                        <a asp-action="Index" asp-route-page="@(ViewBag.CurrentPage - 1)" class="btn btn-secondary">Previous</a>
                    }
                    else
                    {
                        <a class="btn btn-secondary disabled">Previous</a>
                        // Disabled button if on the first page
                    }

                    <span>Page @ViewBag.CurrentPage of @ViewBag.TotalPages</span>

                    @if (ViewBag.CurrentPage < ViewBag.TotalPages) // Check if current page is less than total pages for Next button
                    {
                        <a asp-action="Index" asp-route-page="@(ViewBag.CurrentPage + 1)" class="btn btn-secondary">Next</a>
                    }
                    else
                    {
                        <a class="btn btn-secondary disable">Next</a>
                        // Disabled button if on the last page
                    }
                </div>
            }
        </div>
    </div>
</div>
    @section Scripts {
        @{
            await Html.RenderPartialAsync("_ValidationScriptsPartial");
        }
    <script>
        // Function to hide TempData messages after 3 seconds
        $(document).ready(function () {
            setTimeout(function () {
                $("#createdMessage").fadeOut();
                $("#deletedMessage").fadeOut();
                $("#updatedMessage").fadeOut();
                $("#restoredMessage").fadeOut();
                $("#errorMessage").fadeOut();
            }, 3000);
        });

    </script>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" />
        <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
        <style>
            /* Custom CSS for table */
            .custom-table {
                background-color: rgba(240, 240, 240, 0.8);
                color: #333;
            }

            .Fridge-details-container {
                background-color: #f8f9fa;
                border: 1px solid #ced4da;
                border-radius: .375rem;
                padding: 10px;
                margin: 10px 0;
                box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            }

                .custom-table th,
                .custom-table td {
                    vertical-align: middle;
                }

                .custom-table th {
                    font-weight: bold;
                }

                .custom-table thead th {
                    border-bottom: 2px solid #333;
                }

            .text-center {
                text-align: center;
            }

            .btn-primary {
                background-color: #007bff;
                border-color: #007bff;
            }

                .btn-primary:hover {
                    background-color: #0056b3;
                    border-color: #004db3;
                }

            .btn-info {
                background-color: #17a2b8;
                border-color: #17a2b8;
            }

                .btn-info:hover {
                    background-color: #117a8b;
                    border-color: #117a8b;
                }
        </style>
    }
