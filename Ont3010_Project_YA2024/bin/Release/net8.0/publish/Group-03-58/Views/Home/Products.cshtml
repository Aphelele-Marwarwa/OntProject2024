@model Ont3010_Project_YA2024.Models.PagedFridgeViewModel
@{
    ViewData["Title"] = "Products";
}

<h1>@ViewData["Title"]</h1>

<p class="text-center">Explore our diverse range of fridges. Each card provides detailed information including images, descriptions, and features to help you make the best choice.</p>

<!-- Search and Filter Form -->
<div class="search-filter">
    <form method="get" action="/Home/Products/Search" class="search-form">
        <div class="input-group mb-4">
            <input type="text" name="searchQuery" class="form-control" placeholder="Search by model or type" aria-label="Search" />
            <button type="submit" class="btn btn-primary">Search</button>
        </div>
    </form>

    <form method="get" action="/Home/Products/Sort" class="sort-form">
        <div class="form-group">
            <select name="sortBy" class="form-control">
                <option value="ModelType">Model Type</option>
                <option value="Condition">Condition</option>
                <option value="Size">Size</option>
            </select>
        </div>
        <button type="submit" class="btn btn-primary mt-2">Sort</button>
    </form>
</div>

<div class="container product-cards">
    <div class="row">
        @foreach (var fridge in Model.Fridges)
        {
            <div class="col-md-4 mb-4">
                <div class="card shadow-sm product-card">
                    <!-- Image Section -->
                    <img src="data:image/jpeg;base64,@Convert.ToBase64String(fridge.FridgeImage)" class="card-img-top" alt="@fridge.ModelType">

                    <!-- Details Section -->
                    <div class="card-body">
                       
                        <table class="table table-striped table-hover">
                            <tbody>
                                <tr>
                                    <th scope="row">Model</th>
                                    <td>@fridge.ModelType</td>
                                </tr>
                                <tr>
                                    <th scope="row">Door Type</th>
                                    <td>@fridge.DoorType</td>
                                </tr>
                                <tr>
                                    <th scope="row">Condition</th>
                                    <td>@fridge.Condition</td>
                                </tr>
                                <tr>
                                    <th scope="row">Size</th>
                                    <td>@fridge.Size</td>
                                </tr>
                                <tr>
                                    <th scope="row">Capacity</th>
                                    <td>@fridge.Capacity</td>
                                </tr>
                            </tbody>
                        </table>
                        <button class="btn btn-info btn-view-details" data-id="@fridge.FridgeId" data-serial-number="@fridge.SerialNumber">View Details</button>
                    </div>
                </div>
            </div>
        }
    </div>

    <!-- Pagination -->
    <nav aria-label="Page navigation" class="mt-4">
        <ul class="pagination justify-content-center">
            <li class="page-item @(Model.CurrentPage == 1 ? "disabled" : "")">
                <a class="page-link" href="@Url.Action("Products", new { pageNumber = Model.CurrentPage - 1 })" aria-label="Previous">
                    <span aria-hidden="true">&laquo;</span>
                </a>
            </li>
            @for (var i = 1; i <= Model.TotalPages; i++)
            {
                <li class="page-item @(i == Model.CurrentPage ? "active" : "")">
                    <a class="page-link" href="@Url.Action("Products", new { pageNumber = i })">@i</a>
                </li>
            }
            <li class="page-item @(Model.CurrentPage == Model.TotalPages ? "disabled" : "")">
                <a class="page-link" href="@Url.Action("Products", new { pageNumber = Model.CurrentPage + 1 })" aria-label="Next">
                    <span aria-hidden="true">&raquo;</span>
                </a>
            </li>
        </ul>
    </nav>
</div>

<!-- Details Modal -->
<div class="modal fade" id="detailsModal" tabindex="-1" aria-labelledby="detailsModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="detailsModalLabel">Fridge Details</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                
            </div>
            <div class="modal-footer">
                <a href="/Home/Contact" class="btn btn-secondary">Request More Information</a>
                <button type="button" class="btn btn-primary" data-bs-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    @{
        await Html.RenderPartialAsync("_ValidationScriptsPartial");
    }
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" />
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/5.1.0/js/bootstrap.min.js"></script>

    <style>
        .search-filter {
            margin-bottom: 30px;
            text-align: center;
        }

        .search-form {
            max-width: 600px;
            margin: 0 auto;
        }

        .product-card {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            border: none;
            border-radius: 15px; /* Rounded corners for the card */
            overflow: hidden;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            background: #fff;
        }

            .product-card:hover {
                transform: scale(1.05);
                box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
            }

            .product-card .card-img-top {
                width: 100%;
                height: 200px;
                object-fit: contain; 
            }

            .product-card .card-body {
                padding: 20px;
            }

            .product-card .card-title {
                color: #333;
                font-weight: bold;
                margin-bottom: 15px;
            }

            .product-card .card-text {
                color: #555;
                margin-bottom: 20px;
            }

            .product-card table {
                width: 100%;
                margin-top: 10px;
            }

            .product-card .btn-primary {
                background-color: #007bff;
                border-color: #007bff;
                color: white;
                padding: 10px 20px;
                border-radius: 5px;
                text-transform: uppercase;
                font-weight: bold;
                transition: background-color 0.3s ease, border-color 0.3s ease;
            }

                .product-card .btn-primary:hover {
                    background-color: #0056b3;
                    border-color: #004085;
                }

        h1 {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            color: #007bff;
            margin-bottom: 20px;
            text-align: center;
        }

        p {
            font-family: 'Open Sans', sans-serif;
            color: #6c757d;
            margin-bottom: 30px;
            text-align: center;
        }

        .container.product-cards {
            padding-top: 50px;
            padding-bottom: 50px;
        }

        .pagination .page-item .page-link {
            border-radius: 5px;
            margin: 0 2px;
        }
    </style>
    <script>
        $(document).on('click', '.btn-view-details', function () {
            var fridgeId = $(this).data('id');
            var serialNumber = $(this).data('serial-number');

            $.get('@Url.Action("GetFridgeDetails", "Home")', { id: fridgeId, serialNumber: serialNumber })
                .done(function (data) {
                    $('#detailsModal .modal-body').html(data);
                    $('#detailsModal').modal('show');
                })
                .fail(function () {
                    $('#detailsModal .modal-body').html('<p>Error loading details.</p>');
                });
        });
    </script>
}
