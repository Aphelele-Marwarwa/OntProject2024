@model Ont3010_Project_YA2024.Models.CustomerLiaison.FridgeAllocation

@{
    ViewData["Title"] = "Allocation Details";
    Layout = "~/Views/Shared/_CustomerLayout.cshtml";
}

<div class="container mt-5 allocation-details-page">
    <!-- Fridge Information Card -->
    <div class="card mb-4">
        <div class="card-header">
            <h4 class="card-title">Fridge Information</h4>
        </div>
        <div class="card-body fridge-info">
            <div class="row">
                <div class="col-md-6">
                    <p><strong>Door Type:</strong> @Model.Fridge?.DoorType</p>
                    <p><strong>Size:</strong> @Model.Fridge?.Size</p>
                    <p><strong>Capacity:</strong> @Model.Fridge?.Capacity</p>
                    <p><strong>Condition:</strong> @Model.Fridge?.Condition</p>
                    <p><strong>Serial Number:</strong> @Model.Fridge?.SerialNumber</p>
                </div>
                <div class="col-md-6">
                  
                    <p><strong>Warranty Start Date:</strong> @Model.Fridge?.WarrantyStartDate?.ToString("yyyy-MM-dd")</p>
                    <p><strong>Warranty End Date:</strong> @Model.Fridge?.WarrantyEndDate?.ToString("yyyy-MM-dd")</p>
                  
                </div>
            </div>

            <!-- Show fridge image if available -->
            @if (Model.Fridge?.FridgeImage != null)
            {
                <div class="text-center mt-3 fridge-image-container">
                    <img src="data:image/jpeg;base64,@Convert.ToBase64String(Model.Fridge.FridgeImage)" alt="Fridge Image" class="img-fluid rounded" style="max-width: 400px;" />
                </div>
            }
        </div>
    </div>

    <!-- Allocation Details Card -->
    <div class="card mb-4">
        <div class="card-header">
            <h3 class="card-title">Fridge Allocation Details</h3>
        </div>
        <div class="card-body">
            <h5 class="card-subtitle mb-3">Fridge Model/Type: @Model.Fridge?.ModelType</h5>
            <div class="row">
                <div class="col-md-6">
                    <p><strong>Allocation Date:</strong> @Model.AllocationDate.ToString("yyyy-MM-dd")</p>
                    <p><strong>Duration(Months):</strong> @Model.Duration</p>
                   
                </div>
              
            </div>
        </div>
    </div>

    <!-- Status Section Card -->
    <div class="card mb-4">
        <div class="card-header">
            <h4 class="card-title">Processing and Approval Status</h4>
        </div>
        <div class="card-body">
            <dl class="row">
                <dt class="col-sm-4 col-md-3">
                    <strong>Processing Status:</strong>
                </dt>
                <dd class="col-sm-8 col-md-9">
                    @if (Model.IsProcessed)
                    {
                        <span class="text-success">Processed</span>
                    }
                    else
                    {
                        <span class="text-warning">Pending</span>
                    }
                </dd>

                @if (Model.IsProcessed)
                {
                  
                        var latestProcess = Model.ProcessAllocations.OrderByDescending(pa => pa.LastModifiedDate).FirstOrDefault();
                
                    <dt class="col-sm-4 col-md-3">
                        <strong>Approval Status:</strong>
                    </dt>
                    <dd class="col-sm-8 col-md-9">
                        @latestProcess?.ApprovalStatus
                    </dd>

                    <dt class="col-sm-4 col-md-3">
                        <strong>Approval Note:</strong>
                    </dt>
                    <dd class="col-sm-8 col-md-9">
                        @latestProcess?.ApprovalNote
                    </dd>

                    <dt class="col-sm-4 col-md-3">
                        <strong>Delivery/Pickup Date:</strong>
                    </dt>
                    <dd class="col-sm-8 col-md-9">
                        @latestProcess?.AllocationDate.ToString("yyyy-MM-dd")
                    </dd>
                }
            </dl>
        </div>
    </div>

    <!-- Back Button -->
    <div class="text-center">
        <a asp-controller="CustomerAllocation" asp-action="Index" class="btn btn-primary btn-lg">Back to My Allocations</a>
    </div>
</div>


<style>
    .allocation-details-page {
        padding-top: 20px;
    }

    .card {
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        border-radius: 10px;
    }

    .card-header {
        background-color: #007bff;
        color: white;
    }

    .card-title {
        font-size: 1.4rem;
        margin-bottom: 0;
    }

    .card-subtitle {
        font-size: 1.1rem;
        font-weight: bold;
    }

    .fridge-info p,
    .allocation-details p {
        font-size: 1.1rem;
        color: #333;
    }

    .fridge-image-container img {
        max-width: 100%;
        height: auto;
        border-radius: 8px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
    }

    .status-section .row dt {
        font-weight: bold;
    }

    .text-success {
        color: #28a745;
    }

    .text-warning {
        color: #ffc107;
    }

    .btn-primary {
        background-color: #007bff;
        border-color: #007bff;
        padding: 12px 24px;
        font-size: 1.2rem;
    }

        .btn-primary:hover {
            background-color: #0056b3;
            border-color: #0056b3;
        }


</style>